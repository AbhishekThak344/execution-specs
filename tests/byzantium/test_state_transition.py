from functools import partial

import pytest

from ethereum.utils.ensure import EnsureError
from tests.byzantium.blockchain_st_test_helpers import (
    FIXTURES_LOADER,
    run_byzantium_blockchain_st_tests,
)
from tests.helpers.load_state_tests import fetch_state_test_files

# Run legacy general state tests
test_dir = (
    "tests/fixtures/LegacyTests/Constantinople/BlockchainTests/"
    "GeneralStateTests/"
)

run_general_state_tests = partial(run_byzantium_blockchain_st_tests, test_dir)

# Every test below takes more than  60s to run and
# hence they've been marked as slow
SLOW_TESTS = (
    # TODO: Remove the file names in the list below.
    # These tests are currently failing because some precompiles are not
    # implemented. Marking them as slow for now so that these failing tests
    # get skipped.
    "stPreCompiledContracts/sec80_d0g0v0.json",
    "stZeroKnowledge/ecpairing_one_point_with_g2_zero_and_g1_invalid_d0g2v0.json",  # noqa
    "stZeroKnowledge/ecmul_7827-6598_1456_28000_128_d0g0v0.json",
    "stZeroKnowledge/ecmul_1-2_9_21000_128_d0g3v0.json",
    "stZeroKnowledge/ecmul_1-2_340282366920938463463374607431768211456_28000_96_d0g1v0.json",  # noqa
    "stZeroKnowledge/ecmul_1-2_616_28000_96_d0g0v0.json",
    "stZeroKnowledge/ecpairing_two_point_fail_2_d0g2v0.json",
    "stZeroKnowledge/ecpairing_bad_length_193_d0g3v0.json",
    "stZeroKnowledge/ecpairing_two_point_match_5_d0g1v0.json",
    "stZeroKnowledge/ecmul_1-3_0_28000_128_d0g2v0.json",
    "stZeroKnowledge/ecpairing_empty_data_insufficient_gas_d0g2v0.json",
    "stZeroKnowledge/ecmul_7827-6598_1456_28000_80_d0g0v0.json",
    "stZeroKnowledge/ecmul_7827-6598_1_21000_96_d0g3v0.json",
    "stZeroKnowledge/ecmul_7827-6598_0_21000_80_d0g1v0.json",
    "stZeroKnowledge/ecpairing_three_point_match_1_d0g1v0.json",
    "stZeroKnowledge/ecmul_7827-6598_0_28000_96_d0g0v0.json",
    "stZeroKnowledge/ecmul_7827-6598_0_21000_64_d0g3v0.json",
    "stZeroKnowledge/ecmul_7827-6598_1456_21000_96_d0g1v0.json",
    "stZeroKnowledge/ecmul_1-3_1_28000_128_d0g3v0.json",
    "stZeroKnowledge/pointMulAdd2_d22g0v0.json",
    "stZeroKnowledge/ecmul_7827-6598_9935_28000_96_d0g3v0.json",
    "stZeroKnowledge/pointMulAdd2_d23g0v0.json",
    "stZeroKnowledge/ecmul_1-3_9935_28000_128_d0g2v0.json",
    "stZeroKnowledge/pointAdd_d6g3v0.json",
    "stZeroKnowledge/ecmul_7827-6598_1456_21000_128_d0g3v0.json",
    "stZeroKnowledge/ecmul_1-2_2_28000_128_d0g3v0.json",
    "stZeroKnowledge/ecmul_7827-6598_2_28000_96_d0g3v0.json",
    "stZeroKnowledge/ecmul_7827-6598_9935_21000_128_d0g3v0.json",
    "stZeroKnowledge/pointMulAdd2_d14g3v0.json",
    "stZeroKnowledge/pointMulAdd2_d15g3v0.json",
    "stZeroKnowledge/ecpairing_three_point_fail_1_d0g0v0.json",
    "stZeroKnowledge/ecmul_7827-6598_5616_21000_96_d0g3v0.json",
    "stZeroKnowledge/ecmul_1-2_9_28000_128_d0g0v0.json",
    "stZeroKnowledge/pairingTest_d5g1v0.json",
    "stZeroKnowledge/pairingTest_d4g1v0.json",
    "stZeroKnowledge/ecmul_1-3_0_21000_128_d0g1v0.json",
    "stZeroKnowledge/pointAddTrunc_d6g0v0.json",
    "stZeroKnowledge/pointAddTrunc_d7g0v0.json",
    "stZeroKnowledge/ecpairing_two_point_match_4_d0g2v0.json",
    "stZeroKnowledge/ecmul_1-3_2_21000_128_d0g3v0.json",
    "stZeroKnowledge/ecmul_1-3_340282366920938463463374607431768211456_21000_80_d0g1v0.json",  # noqa
    "stZeroKnowledge/ecmul_1-2_9_28000_96_d0g0v0.json",
    "stZeroKnowledge/ecpairing_two_point_match_1_d0g0v0.json",
    "stZeroKnowledge/ecmul_1-2_9935_21000_96_d0g1v0.json",
    "stZeroKnowledge/ecmul_1-2_5617_21000_128_d0g1v0.json",
    "stZeroKnowledge/pointAddTrunc_d5g3v0.json",
    "stZeroKnowledge/ecpairing_one_point_with_g1_zero_d0g2v0.json",
    "stZeroKnowledge/ecmul_1-2_5616_28000_128_d0g3v0.json",
    "stZeroKnowledge/ecmul_1-3_5617_28000_96_d0g2v0.json",
    "stZeroKnowledge/ecmul_1-3_1_21000_96_d0g2v0.json",
    "stZeroKnowledge/pointAdd_d4g0v0.json",
    "stZeroKnowledge/pointAdd_d5g0v0.json",
    "stZeroKnowledge/pointMulAdd2_d16g0v0.json",
    "stZeroKnowledge/pointMulAdd2_d17g0v0.json",
    "stZeroKnowledge/ecmul_1-2_5617_21000_96_d0g2v0.json",
    "stZeroKnowledge/ecpairing_perturb_g2_by_field_modulus_d0g0v0.json",
    "stZeroKnowledge/ecmul_1-3_0_28000_96_d0g1v0.json",
    "stZeroKnowledge/ecmul_1-3_2_28000_128_d0g0v0.json",
    "stZeroKnowledge/ecmul_1-3_0_21000_64_d0g2v0.json",
    "stZeroKnowledge/ecmul_1-3_5616_21000_96_d0g1v0.json",
    "stZeroKnowledge/ecmul_1-3_2_28000_96_d0g2v0.json",
    "stZeroKnowledge/ecmul_1-2_5617_28000_128_d0g2v0.json",
    "stZeroKnowledge/ecpairing_two_point_oog_d0g3v0.json",
    "stZeroKnowledge/ecmul_1-3_9_28000_128_d0g3v0.json",
    "stZeroKnowledge/pointMulAdd2_d28g0v0.json",
    "stZeroKnowledge/ecmul_1-3_9935_28000_96_d0g1v0.json",
    "stZeroKnowledge/pointMulAdd2_d29g0v0.json",
    "stZeroKnowledge/ecmul_1-3_340282366920938463463374607431768211456_28000_96_d0g0v0.json",  # noqa
    "stZeroKnowledge/pointAdd_d4g2v0.json",
    "stZeroKnowledge/pointAdd_d5g2v0.json",
    "stZeroKnowledge/ecmul_1-3_0_21000_80_d0g2v0.json",
    "stZeroKnowledge/ecmul_1-3_9_21000_128_d0g2v0.json",
    "stZeroKnowledge/ecpairing_one_point_with_g1_zero_d0g0v0.json",
    "stZeroKnowledge/ecmul_1-3_5617_28000_96_d0g0v0.json",
    "stZeroKnowledge/ecmul_1-2_5616_28000_128_d0g1v0.json",
    "stZeroKnowledge/ecmul_1-2_9935_21000_96_d0g3v0.json",
    "stZeroKnowledge/ecmul_7827-6598_9_21000_96_d0g2v0.json",
    "stZeroKnowledge/ecmul_1-2_5617_21000_128_d0g3v0.json",
    "stZeroKnowledge/pointMulAdd_d8g0v0.json",
    "stZeroKnowledge/pointAddTrunc_d5g1v0.json",
    "stZeroKnowledge/ecpairing_two_point_match_4_d0g0v0.json",
    "stZeroKnowledge/ecmul_1-3_2_21000_128_d0g1v0.json",
    "stZeroKnowledge/ecmul_1-3_340282366920938463463374607431768211456_21000_80_d0g3v0.json",  # noqa
    "stZeroKnowledge/ecpairing_two_point_match_1_d0g2v0.json",
    "stZeroKnowledge/pointMulAdd2_d4g3v0.json",
    "stZeroKnowledge/pointMulAdd2_d5g3v0.json",
    "stZeroKnowledge/ecmul_1-2_9_28000_96_d0g2v0.json",
    "stZeroKnowledge/ecmul_1-3_9935_28000_96_d0g3v0.json",
    "stZeroKnowledge/ecmul_1-3_9_28000_128_d0g1v0.json",
    "stZeroKnowledge/ecmul_1-3_340282366920938463463374607431768211456_28000_96_d0g2v0.json",  # noqa
    "stZeroKnowledge/ecmul_1-2_5616_21000_128_d0g2v0.json",
    "stZeroKnowledge/ecpairing_two_point_oog_d0g1v0.json",
    "stZeroKnowledge/ecmul_1-2_5617_28000_128_d0g0v0.json",
    "stZeroKnowledge/ecmul_1-3_5616_21000_96_d0g3v0.json",
    "stZeroKnowledge/ecmul_1-3_2_28000_96_d0g0v0.json",
    "stZeroKnowledge/pointMulAdd_d1g3v0.json",
    "stZeroKnowledge/pointMulAdd_d0g3v0.json",
    "stZeroKnowledge/pointMulAdd2_d35g0v0.json",
    "stZeroKnowledge/pointMulAdd2_d34g0v0.json",
    "stZeroKnowledge/ecmul_1-3_0_28000_96_d0g3v0.json",
    "stZeroKnowledge/ecmul_1-3_2_28000_128_d0g2v0.json",
    "stZeroKnowledge/ecpairing_perturb_g2_by_field_modulus_d0g2v0.json",
    "stZeroKnowledge/ecmul_1-3_0_28000_128_d0g0v0.json",
    "stZeroKnowledge/ecpairing_empty_data_insufficient_gas_d0g0v0.json",
    "stZeroKnowledge/ecpairing_two_point_match_5_d0g3v0.json",
    "stZeroKnowledge/ecpairing_three_point_match_1_d0g3v0.json",
    "stZeroKnowledge/ecmul_7827-6598_1456_28000_80_d0g2v0.json",
    "stZeroKnowledge/ecmul_7827-6598_1_21000_96_d0g1v0.json",
    "stZeroKnowledge/ecmul_7827-6598_0_21000_80_d0g3v0.json",
    "stZeroKnowledge/ecmul_1-2_9_21000_128_d0g1v0.json",
    "stZeroKnowledge/pointMulAdd_d3g0v0.json",
    "stZeroKnowledge/ecmul_1-2_616_28000_96_d0g2v0.json",
    "stZeroKnowledge/pointMulAdd_d2g0v0.json",
    "stZeroKnowledge/ecmul_1-2_340282366920938463463374607431768211456_28000_96_d0g3v0.json",  # noqa
    "stZeroKnowledge/ecpairing_two_point_fail_2_d0g0v0.json",
    "stZeroKnowledge/ecpairing_bad_length_193_d0g1v0.json",
    "stZeroKnowledge/pointMulAdd2_d36g3v0.json",
    "stZeroKnowledge/ecmul_7827-6598_5617_28000_96_d0g2v0.json",
    "stZeroKnowledge/ecmul_7827-6598_9935_28000_128_d0g2v0.json",
    "stZeroKnowledge/ecmul_1-3_9_21000_96_d0g3v0.json",
    "stZeroKnowledge/ecpairing_one_point_with_g2_zero_and_g1_invalid_d0g0v0.json",  # noqa
    "stZeroKnowledge/ecmul_7827-6598_1456_28000_128_d0g2v0.json",
    "stZeroKnowledge/ecmul_1-3_1_21000_128_d0g2v0.json",
    "stZeroKnowledge/ecmul_1-3_9935_21000_128_d0g3v0.json",
    "stZeroKnowledge/pairingTest_d5g3v0.json",
    "stZeroKnowledge/pairingTest_d4g3v0.json",
    "stZeroKnowledge/ecpairing_three_point_fail_1_d0g2v0.json",
    "stZeroKnowledge/ecmul_7827-6598_9_28000_128_d0g0v0.json",
    "stZeroKnowledge/ecmul_1-3_5616_28000_96_d0g2v0.json",
    "stZeroKnowledge/ecmul_1-3_2_21000_96_d0g1v0.json",
    "stZeroKnowledge/ecmul_7827-6598_5617_28000_128_d0g2v0.json",
    "stZeroKnowledge/pointMulAdd2_d3g3v0.json",
    "stZeroKnowledge/ecpairing_perturb_g2_by_one_d0g1v0.json",
    "stZeroKnowledge/ecmul_7827-6598_2_28000_128_d0g3v0.json",
    "stZeroKnowledge/pointMulAdd2_d2g3v0.json",
    "stZeroKnowledge/pairingTest_d0g0v0.json",
    "stZeroKnowledge/pairingTest_d1g0v0.json",
    "stZeroKnowledge/ecmul_1-3_9935_21000_96_d0g2v0.json",
    "stZeroKnowledge/ecmul_1-3_340282366920938463463374607431768211456_21000_96_d0g3v0.json",  # noqa
    "stZeroKnowledge/ecmul_1-3_5616_28000_128_d0g1v0.json",
    "stZeroKnowledge/ecpairing_perturb_g2_by_field_modulus_again_d0g2v0.json",
    "stZeroKnowledge/ecmul_1-3_5617_28000_128_d0g0v0.json",
    "stZeroKnowledge/ecmul_1-3_340282366920938463463374607431768211456_28000_80_d0g2v0.json",  # noqa
    "stZeroKnowledge/ecmul_1-2_9_21000_96_d0g3v0.json",
    "stZeroKnowledge/ecmul_7827-6598_5617_21000_128_d0g1v0.json",
    "stZeroKnowledge/ecmul_1-2_9935_28000_96_d0g2v0.json",
    "stZeroKnowledge/ecmul_7827-6598_9_21000_128_d0g3v0.json",
    "stZeroKnowledge/ecmul_7827-6598_9_28000_96_d0g3v0.json",
    "stZeroKnowledge/pointMulAdd_d6g3v0.json",
    "stZeroKnowledge/ecmul_7827-6598_5616_28000_128_d0g3v0.json",
    "stZeroKnowledge/ecpairing_two_point_match_3_d0g1v0.json",
    "stZeroKnowledge/pointMulAdd2_d32g0v0.json",
    "stZeroKnowledge/pointMulAdd2_d33g0v0.json",
    "stZeroKnowledge/ecmul_1-3_5617_21000_96_d0g1v0.json",
    "stZeroKnowledge/ecmul_1-2_5616_21000_96_d0g2v0.json",
    "stZeroKnowledge/ecmul_1-3_5616_21000_128_d0g2v0.json",
    "stZeroKnowledge/ecmul_1-3_0_28000_80_d0g3v0.json",
    "stZeroKnowledge/ecmul_1-3_1_28000_96_d0g1v0.json",
    "stZeroKnowledge/ecpairing_two_point_fail_1_d0g0v0.json",
    "stZeroKnowledge/ecmul_7827-6598_0_28000_64_d0g0v0.json",
    "stZeroKnowledge/ecmul_7827-6598_0_21000_96_d0g3v0.json",
    "stZeroKnowledge/ecmul_7827-6598_1456_28000_96_d0g2v0.json",
    "stZeroKnowledge/pointMulAdd_d4g0v0.json",
    "stZeroKnowledge/pointAddTrunc_d8g1v0.json",
    "stZeroKnowledge/pointMulAdd_d5g0v0.json",
    "stZeroKnowledge/ecmul_1-2_2_28000_96_d0g0v0.json",
    "stZeroKnowledge/pointMulAdd2_d9g3v0.json",
    "stZeroKnowledge/pointMulAdd2_d8g3v0.json",
    "stZeroKnowledge/ecpairing_perturb_g2_by_curve_order_d0g0v0.json",
    "stZeroKnowledge/ecmul_1-2_9935_21000_128_d0g3v0.json",
    "stZeroKnowledge/ecmul_1-2_340282366920938463463374607431768211456_28000_80_d0g3v0.json",  # noqa
    "stZeroKnowledge/ecmul_7827-6598_0_21000_128_d0g2v0.json",
    "stZeroKnowledge/ecmul_1-2_340282366920938463463374607431768211456_28000_128_d0g1v0.json",  # noqa
    "stZeroKnowledge/ecmul_1-3_340282366920938463463374607431768211456_28000_128_d0g0v0.json",  # noqa
    "stZeroKnowledge/ecpairing_one_point_fail_d0g2v0.json",
    "stZeroKnowledge/pointAdd_d9g2v0.json",
    "stZeroKnowledge/ecmul_7827-6598_5616_28000_96_d0g0v0.json",
    "stZeroKnowledge/ecmul_7827-6598_1_28000_128_d0g0v0.json",
    "stZeroKnowledge/ecpairing_one_point_not_in_subgroup_d0g1v0.json",
    "stZeroKnowledge/ecpairing_bad_length_191_d0g2v0.json",
    "stZeroKnowledge/ecpairing_perturb_zeropoint_by_curve_order_d0g3v0.json",
    "stZeroKnowledge/pointMulAdd2_d1g0v0.json",
    "stZeroKnowledge/pointMulAdd2_d0g0v0.json",
    "stZeroKnowledge/ecmul_7827-6598_5617_21000_96_d0g3v0.json",
    "stZeroKnowledge/ecmul_7827-6598_0_28000_128_d0g1v0.json",
    "stZeroKnowledge/ecpairing_two_point_match_2_d0g2v0.json",
    "stZeroKnowledge/pairingTest_d2g3v0.json",
    "stZeroKnowledge/ecmul_1-3_9_28000_96_d0g2v0.json",
    "stZeroKnowledge/ecpairing_perturb_zeropoint_by_one_d0g2v0.json",
    "stZeroKnowledge/pairingTest_d3g3v0.json",
    "stZeroKnowledge/ecmul_1-2_9935_28000_128_d0g0v0.json",
    "stZeroKnowledge/ecpairing_empty_data_d0g0v0.json",
    "stZeroKnowledge/ecpairing_one_point_with_g2_zero_d0g3v0.json",
    "stZeroKnowledge/ecmul_7827-6598_1_21000_128_d0g3v0.json",
    "stZeroKnowledge/ecmul_1-3_340282366920938463463374607431768211456_21000_128_d0g3v0.json",  # noqa
    "stZeroKnowledge/ecpairing_perturb_zeropoint_by_field_modulus_d0g2v0.json",
    "stZeroKnowledge/ecmul_1-2_340282366920938463463374607431768211456_21000_96_d0g2v0.json",  # noqa
    "stZeroKnowledge/ecmul_1-2_340282366920938463463374607431768211456_21000_128_d0g2v0.json",  # noqa
    "stZeroKnowledge/ecpairing_one_point_insufficient_gas_d0g0v0.json",
    "stZeroKnowledge/pointAdd_d1g1v0.json",
    "stZeroKnowledge/ecpairing_two_points_with_one_g2_zero_d0g2v0.json",
    "stZeroKnowledge/pointAdd_d0g1v0.json",
    "stZeroKnowledge/ecmul_7827-6598_1456_21000_80_d0g3v0.json",
    "stZeroKnowledge/ecmul_7827-6598_1_28000_96_d0g0v0.json",
    "stZeroKnowledge/ecmul_7827-6598_0_28000_80_d0g2v0.json",
    "stZeroKnowledge/ecpairing_one_point_not_in_subgroup_d0g3v0.json",
    "stZeroKnowledge/ecmul_1-2_340282366920938463463374607431768211456_28000_128_d0g3v0.json",  # noqa
    "stZeroKnowledge/ecmul_7827-6598_5616_28000_96_d0g2v0.json",
    "stZeroKnowledge/ecmul_7827-6598_1_28000_128_d0g2v0.json",
    "stZeroKnowledge/ecmul_1-3_340282366920938463463374607431768211456_28000_128_d0g2v0.json",  # noqa
    "stZeroKnowledge/ecpairing_one_point_fail_d0g0v0.json",
    "stZeroKnowledge/pointAdd_d9g0v0.json",
    "stZeroKnowledge/pointAdd_d8g0v0.json",
    "stZeroKnowledge/ecmul_1-2_9935_21000_128_d0g1v0.json",
    "stZeroKnowledge/ecpairing_perturb_g2_by_curve_order_d0g2v0.json",
    "stZeroKnowledge/ecmul_7827-6598_2_21000_96_d0g2v0.json",
    "stZeroKnowledge/ecmul_1-2_340282366920938463463374607431768211456_28000_80_d0g1v0.json",  # noqa
    "stZeroKnowledge/pointAddTrunc_d9g3v0.json",
    "stZeroKnowledge/pointAddTrunc_d8g3v0.json",
    "stZeroKnowledge/ecmul_7827-6598_0_28000_64_d0g2v0.json",
    "stZeroKnowledge/ecmul_7827-6598_0_21000_96_d0g1v0.json",
    "stZeroKnowledge/ecmul_7827-6598_1456_28000_96_d0g0v0.json",
    "stZeroKnowledge/ecmul_1-2_2_28000_96_d0g2v0.json",
    "stZeroKnowledge/ecmul_7827-6598_9935_21000_96_d0g2v0.json",
    "stZeroKnowledge/pointAdd_d1g3v0.json",
    "stZeroKnowledge/ecpairing_two_points_with_one_g2_zero_d0g0v0.json",
    "stZeroKnowledge/pointAdd_d0g3v0.json",
    "stZeroKnowledge/ecmul_7827-6598_1456_21000_80_d0g1v0.json",
    "stZeroKnowledge/ecmul_7827-6598_1_28000_96_d0g2v0.json",
    "stZeroKnowledge/ecmul_7827-6598_0_28000_80_d0g0v0.json",
    "stZeroKnowledge/pointMulAdd2_d13g3v0.json",
    "stZeroKnowledge/pointMulAdd2_d12g3v0.json",
    "stZeroKnowledge/ecmul_1-3_340282366920938463463374607431768211456_21000_128_d0g1v0.json",  # noqa
    "stZeroKnowledge/ecpairing_perturb_zeropoint_by_field_modulus_d0g0v0.json",
    "stZeroKnowledge/ecpairing_one_point_with_g2_zero_d0g1v0.json",
    "stZeroKnowledge/ecmul_7827-6598_1_21000_128_d0g1v0.json",
    "stZeroKnowledge/ecpairing_one_point_insufficient_gas_d0g2v0.json",
    "stZeroKnowledge/pointMulAdd2_d25g0v0.json",
    "stZeroKnowledge/pointMulAdd2_d24g0v0.json",
    "stZeroKnowledge/ecpairing_two_point_match_2_d0g0v0.json",
    "stZeroKnowledge/pairingTest_d2g1v0.json",
    "stZeroKnowledge/ecmul_1-3_9_28000_96_d0g0v0.json",
    "stZeroKnowledge/ecpairing_perturb_zeropoint_by_one_d0g0v0.json",
    "stZeroKnowledge/pairingTest_d3g1v0.json",
    "stZeroKnowledge/ecmul_7827-6598_0_28000_128_d0g3v0.json",
    "stZeroKnowledge/ecmul_7827-6598_5617_21000_96_d0g1v0.json",
    "stZeroKnowledge/ecpairing_empty_data_d0g2v0.json",
    "stZeroKnowledge/pointAddTrunc_d1g0v0.json",
    "stZeroKnowledge/ecmul_1-2_9935_28000_128_d0g2v0.json",
    "stZeroKnowledge/pointAddTrunc_d0g0v0.json",
    "stZeroKnowledge/ecpairing_bad_length_191_d0g0v0.json",
    "stZeroKnowledge/ecpairing_perturb_zeropoint_by_curve_order_d0g1v0.json",
    "stZeroKnowledge/pairingTest_d0g2v0.json",
    "stZeroKnowledge/pairingTest_d1g2v0.json",
    "stZeroKnowledge/ecmul_1-3_5616_28000_128_d0g3v0.json",
    "stZeroKnowledge/ecpairing_perturb_g2_by_field_modulus_again_d0g0v0.json",
    "stZeroKnowledge/pointAddTrunc_d3g3v0.json",
    "stZeroKnowledge/pointAddTrunc_d2g3v0.json",
    "stZeroKnowledge/ecmul_1-3_340282366920938463463374607431768211456_21000_96_d0g1v0.json",  # noqa
    "stZeroKnowledge/ecmul_7827-6598_5616_21000_128_d0g2v0.json",
    "stZeroKnowledge/ecpairing_perturb_g2_by_one_d0g3v0.json",
    "stZeroKnowledge/ecmul_7827-6598_2_28000_128_d0g1v0.json",
    "stZeroKnowledge/ecmul_7827-6598_9_28000_128_d0g2v0.json",
    "stZeroKnowledge/ecmul_1-3_5616_28000_96_d0g0v0.json",
    "stZeroKnowledge/ecmul_1-3_2_21000_96_d0g3v0.json",
    "stZeroKnowledge/pointAdd_d3g0v0.json",
    "stZeroKnowledge/pointAdd_d2g0v0.json",
    "stZeroKnowledge/pointMulAdd2_d11g0v0.json",
    "stZeroKnowledge/pointMulAdd2_d10g0v0.json",
    "stZeroKnowledge/ecmul_7827-6598_5617_28000_128_d0g0v0.json",
    "stZeroKnowledge/pointMulAdd2_d27g3v0.json",
    "stZeroKnowledge/ecmul_1-3_5617_21000_128_d0g1v0.json",
    "stZeroKnowledge/ecmul_1-2_5617_28000_96_d0g3v0.json",
    "stZeroKnowledge/ecmul_1-3_0_28000_64_d0g3v0.json",
    "stZeroKnowledge/ecmul_1-3_0_28000_80_d0g1v0.json",
    "stZeroKnowledge/ecmul_1-3_1_28000_96_d0g3v0.json",
    "stZeroKnowledge/ecpairing_two_point_fail_1_d0g2v0.json",
    "stZeroKnowledge/ecpairing_two_point_match_3_d0g3v0.json",
    "stZeroKnowledge/ecmul_7827-6598_2_21000_128_d0g2v0.json",
    "stZeroKnowledge/ecmul_7827-6598_5616_28000_128_d0g1v0.json",
    "stZeroKnowledge/ecmul_1-3_5617_21000_96_d0g3v0.json",
    "stZeroKnowledge/ecmul_1-2_9935_28000_96_d0g0v0.json",
    "stZeroKnowledge/ecmul_7827-6598_5617_21000_128_d0g3v0.json",
    "stZeroKnowledge/ecmul_7827-6598_9_28000_96_d0g1v0.json",
    "stZeroKnowledge/ecmul_7827-6598_9_21000_128_d0g1v0.json",
    "stZeroKnowledge/ecmul_1-3_340282366920938463463374607431768211456_28000_80_d0g0v0.json",  # noqa
    "stZeroKnowledge/ecmul_1-3_5617_28000_128_d0g2v0.json",
    "stZeroKnowledge/pointMulAdd2_d19g3v0.json",
    "stZeroKnowledge/pointMulAdd2_d18g3v0.json",
    "stZeroKnowledge/ecmul_1-2_9_21000_96_d0g1v0.json",
    "stZeroKnowledge/ecmul_1-3_2_28000_96_d0g3v0.json",
    "stZeroKnowledge/ecmul_1-2_5617_28000_128_d0g3v0.json",
    "stZeroKnowledge/ecpairing_perturb_g2_by_field_modulus_d0g1v0.json",
    "stZeroKnowledge/ecmul_1-2_5617_21000_96_d0g3v0.json",
    "stZeroKnowledge/ecmul_1-3_0_28000_96_d0g0v0.json",
    "stZeroKnowledge/ecmul_1-3_2_28000_128_d0g1v0.json",
    "stZeroKnowledge/ecmul_1-3_0_21000_64_d0g3v0.json",
    "stZeroKnowledge/pointMulAdd2_d35g3v0.json",
    "stZeroKnowledge/pointMulAdd_d0g0v0.json",
    "stZeroKnowledge/pointMulAdd_d1g0v0.json",
    "stZeroKnowledge/ecmul_1-3_340282366920938463463374607431768211456_28000_96_d0g1v0.json",  # noqa
    "stZeroKnowledge/ecmul_1-3_9_28000_128_d0g2v0.json",
    "stZeroKnowledge/ecmul_1-3_9935_28000_96_d0g0v0.json",
    "stZeroKnowledge/ecpairing_two_point_oog_d0g2v0.json",
    "stZeroKnowledge/ecmul_1-2_5616_21000_128_d0g1v0.json",
    "stZeroKnowledge/pointMulAdd_d8g3v0.json",
    "stZeroKnowledge/pointAddTrunc_d5g2v0.json",
    "stZeroKnowledge/ecmul_7827-6598_9_21000_96_d0g1v0.json",
    "stZeroKnowledge/ecmul_1-2_9_28000_96_d0g1v0.json",
    "stZeroKnowledge/pointMulAdd2_d5g0v0.json",
    "stZeroKnowledge/ecpairing_two_point_match_1_d0g1v0.json",
    "stZeroKnowledge/pointMulAdd2_d4g0v0.json",
    "stZeroKnowledge/ecmul_1-3_2_21000_128_d0g2v0.json",
    "stZeroKnowledge/ecpairing_two_point_match_4_d0g3v0.json",
    "stZeroKnowledge/ecmul_1-3_9_21000_128_d0g1v0.json",
    "stZeroKnowledge/ecmul_1-3_1_21000_96_d0g3v0.json",
    "stZeroKnowledge/ecmul_1-3_0_21000_80_d0g1v0.json",
    "stZeroKnowledge/pointAdd_d5g1v0.json",
    "stZeroKnowledge/pointAdd_d4g1v0.json",
    "stZeroKnowledge/ecmul_1-2_5616_28000_128_d0g2v0.json",
    "stZeroKnowledge/ecmul_1-3_5617_28000_96_d0g3v0.json",
    "stZeroKnowledge/ecpairing_one_point_with_g1_zero_d0g3v0.json",
    "stZeroKnowledge/ecmul_7827-6598_2_28000_96_d0g2v0.json",
    "stZeroKnowledge/ecmul_1-2_340282366920938463463374607431768211456_21000_80_d0g1v0.json",  # noqa
    "stZeroKnowledge/ecmul_7827-6598_9935_21000_128_d0g2v0.json",
    "stZeroKnowledge/pointAdd_d7g2v0.json",
    "stZeroKnowledge/ecmul_7827-6598_1456_21000_128_d0g2v0.json",
    "stZeroKnowledge/ecmul_1-2_2_28000_128_d0g2v0.json",
    "stZeroKnowledge/pointAdd_d6g2v0.json",
    "stZeroKnowledge/ecmul_1-3_1_28000_128_d0g2v0.json",
    "stZeroKnowledge/ecmul_7827-6598_9935_28000_96_d0g2v0.json",
    "stZeroKnowledge/ecmul_1-3_9935_28000_128_d0g3v0.json",
    "stZeroKnowledge/ecmul_7827-6598_0_28000_96_d0g1v0.json",
    "stZeroKnowledge/ecmul_7827-6598_0_21000_64_d0g2v0.json",
    "stZeroKnowledge/pointAddTrunc_d7g1v0.json",
    "stZeroKnowledge/pointAddTrunc_d6g1v0.json",
    "stZeroKnowledge/pairingTest_d4g0v0.json",
    "stZeroKnowledge/pairingTest_d5g0v0.json",
    "stZeroKnowledge/ecmul_7827-6598_5616_21000_96_d0g2v0.json",
    "stZeroKnowledge/pointMulAdd2_d7g3v0.json",
    "stZeroKnowledge/pointMulAdd2_d6g3v0.json",
    "stZeroKnowledge/ecmul_1-2_9_28000_128_d0g1v0.json",
    "stZeroKnowledge/ecpairing_three_point_fail_1_d0g1v0.json",
    "stZeroKnowledge/ecpairing_one_point_with_g2_zero_and_g1_invalid_d0g3v0.json",  # noqa
    "stZeroKnowledge/ecmul_7827-6598_1456_28000_128_d0g1v0.json",
    "stZeroKnowledge/ecmul_7827-6598_9935_28000_128_d0g1v0.json",
    "stZeroKnowledge/ecmul_7827-6598_5617_28000_96_d0g1v0.json",
    "stZeroKnowledge/ecmul_1-3_1_21000_128_d0g1v0.json",
    "stZeroKnowledge/ecmul_7827-6598_1456_28000_80_d0g1v0.json",
    "stZeroKnowledge/ecmul_7827-6598_1_21000_96_d0g2v0.json",
    "stZeroKnowledge/ecpairing_three_point_match_1_d0g0v0.json",
    "stZeroKnowledge/ecpairing_two_point_match_5_d0g0v0.json",
    "stZeroKnowledge/ecmul_1-3_0_28000_128_d0g3v0.json",
    "stZeroKnowledge/ecpairing_empty_data_insufficient_gas_d0g3v0.json",
    "stZeroKnowledge/pointMulAdd2_d36g0v0.json",
    "stZeroKnowledge/pointMulAdd2_d37g0v0.json",
    "stZeroKnowledge/ecpairing_two_point_fail_2_d0g3v0.json",
    "stZeroKnowledge/ecpairing_bad_length_193_d0g2v0.json",
    "stZeroKnowledge/pointMulAdd_d2g3v0.json",
    "stZeroKnowledge/ecmul_1-2_340282366920938463463374607431768211456_28000_96_d0g0v0.json",  # noqa
    "stZeroKnowledge/ecmul_1-2_616_28000_96_d0g1v0.json",
    "stZeroKnowledge/ecmul_1-2_9_21000_128_d0g2v0.json",
    "stZeroKnowledge/pointMulAdd_d3g3v0.json",
    "stZeroKnowledge/ecmul_1-2_9_28000_128_d0g3v0.json",
    "stZeroKnowledge/ecpairing_three_point_fail_1_d0g3v0.json",
    "stZeroKnowledge/pointAddTrunc_d7g3v0.json",
    "stZeroKnowledge/pointAddTrunc_d6g3v0.json",
    "stZeroKnowledge/ecmul_1-3_0_21000_128_d0g2v0.json",
    "stZeroKnowledge/pairingTest_d4g2v0.json",
    "stZeroKnowledge/pairingTest_d5g2v0.json",
    "stZeroKnowledge/ecmul_7827-6598_9935_28000_96_d0g0v0.json",
    "stZeroKnowledge/pointMulAdd2_d23g3v0.json",
    "stZeroKnowledge/ecmul_1-3_9935_28000_128_d0g1v0.json",
    "stZeroKnowledge/pointMulAdd2_d22g3v0.json",
    "stZeroKnowledge/ecmul_1-3_1_28000_128_d0g0v0.json",
    "stZeroKnowledge/ecmul_7827-6598_1456_21000_96_d0g2v0.json",
    "stZeroKnowledge/ecmul_7827-6598_0_28000_96_d0g3v0.json",
    "stZeroKnowledge/pointMulAdd2_d15g0v0.json",
    "stZeroKnowledge/ecmul_1-2_340282366920938463463374607431768211456_21000_80_d0g3v0.json",  # noqa
    "stZeroKnowledge/pointMulAdd2_d14g0v0.json",
    "stZeroKnowledge/ecmul_7827-6598_2_28000_96_d0g0v0.json",
    "stZeroKnowledge/pointAdd_d7g0v0.json",
    "stZeroKnowledge/ecmul_1-2_2_28000_128_d0g0v0.json",
    "stZeroKnowledge/pointAdd_d6g0v0.json",
    "stZeroKnowledge/ecpairing_two_point_fail_2_d0g1v0.json",
    "stZeroKnowledge/ecpairing_bad_length_193_d0g0v0.json",
    "stZeroKnowledge/ecmul_1-2_616_28000_96_d0g3v0.json",
    "stZeroKnowledge/ecmul_1-2_340282366920938463463374607431768211456_28000_96_d0g2v0.json",  # noqa
    "stZeroKnowledge/ecpairing_three_point_match_1_d0g2v0.json",
    "stZeroKnowledge/ecmul_7827-6598_0_21000_80_d0g2v0.json",
    "stZeroKnowledge/ecmul_7827-6598_1456_28000_80_d0g3v0.json",
    "stZeroKnowledge/ecmul_1-3_0_28000_128_d0g1v0.json",
    "stZeroKnowledge/ecpairing_empty_data_insufficient_gas_d0g1v0.json",
    "stZeroKnowledge/ecpairing_two_point_match_5_d0g2v0.json",
    "stZeroKnowledge/ecmul_1-3_1_21000_128_d0g3v0.json",
    "stZeroKnowledge/ecmul_1-3_9935_21000_128_d0g2v0.json",
    "stZeroKnowledge/ecpairing_one_point_with_g2_zero_and_g1_invalid_d0g1v0.json",  # noqa
    "stZeroKnowledge/ecmul_7827-6598_1456_28000_128_d0g3v0.json",
    "stZeroKnowledge/ecmul_7827-6598_5617_28000_96_d0g3v0.json",
    "stZeroKnowledge/ecmul_1-3_9_21000_96_d0g2v0.json",
    "stZeroKnowledge/ecmul_7827-6598_9935_28000_128_d0g3v0.json",
    "stZeroKnowledge/ecpairing_two_point_oog_d0g0v0.json",
    "stZeroKnowledge/ecmul_1-2_5616_21000_128_d0g3v0.json",
    "stZeroKnowledge/ecmul_1-3_340282366920938463463374607431768211456_28000_96_d0g3v0.json",  # noqa
    "stZeroKnowledge/ecmul_1-3_9935_28000_96_d0g2v0.json",
    "stZeroKnowledge/pointMulAdd2_d29g3v0.json",
    "stZeroKnowledge/pointMulAdd2_d28g3v0.json",
    "stZeroKnowledge/ecmul_1-3_9_28000_128_d0g0v0.json",
    "stZeroKnowledge/ecmul_1-3_0_28000_96_d0g2v0.json",
    "stZeroKnowledge/ecmul_1-3_2_28000_128_d0g3v0.json",
    "stZeroKnowledge/ecmul_1-3_0_21000_64_d0g1v0.json",
    "stZeroKnowledge/ecpairing_perturb_g2_by_field_modulus_d0g3v0.json",
    "stZeroKnowledge/ecmul_1-2_5617_21000_96_d0g1v0.json",
    "stZeroKnowledge/ecmul_1-2_5617_28000_128_d0g1v0.json",
    "stZeroKnowledge/ecmul_1-3_5616_21000_96_d0g2v0.json",
    "stZeroKnowledge/ecmul_1-3_2_28000_96_d0g1v0.json",
    "stZeroKnowledge/ecmul_1-3_5617_28000_96_d0g1v0.json",
    "stZeroKnowledge/pointMulAdd2_d21g0v0.json",
    "stZeroKnowledge/ecmul_1-2_5616_28000_128_d0g0v0.json",
    "stZeroKnowledge/pointMulAdd2_d20g0v0.json",
    "stZeroKnowledge/ecpairing_one_point_with_g1_zero_d0g1v0.json",
    "stZeroKnowledge/ecmul_1-3_9_21000_128_d0g3v0.json",
    "stZeroKnowledge/pointMulAdd2_d16g3v0.json",
    "stZeroKnowledge/pointAdd_d5g3v0.json",
    "stZeroKnowledge/pointAdd_d4g3v0.json",
    "stZeroKnowledge/ecmul_1-3_1_21000_96_d0g1v0.json",
    "stZeroKnowledge/ecmul_1-3_0_21000_80_d0g3v0.json",
    "stZeroKnowledge/ecpairing_two_point_match_1_d0g3v0.json",
    "stZeroKnowledge/ecmul_1-2_9_28000_96_d0g3v0.json",
    "stZeroKnowledge/ecmul_1-3_340282366920938463463374607431768211456_21000_80_d0g2v0.json",  # noqa
    "stZeroKnowledge/ecpairing_two_point_match_4_d0g1v0.json",
    "stZeroKnowledge/ecpairing_empty_data_d0g1v0.json",
    "stZeroKnowledge/ecmul_7827-6598_5617_21000_96_d0g2v0.json",
    "stZeroKnowledge/ecmul_7827-6598_0_28000_128_d0g0v0.json",
    "stZeroKnowledge/ecmul_1-3_9_28000_96_d0g3v0.json",
    "stZeroKnowledge/ecpairing_perturb_zeropoint_by_one_d0g3v0.json",
    "stZeroKnowledge/pairingTest_d3g2v0.json",
    "stZeroKnowledge/ecpairing_two_point_match_2_d0g3v0.json",
    "stZeroKnowledge/pairingTest_d2g2v0.json",
    "stZeroKnowledge/ecpairing_perturb_zeropoint_by_curve_order_d0g2v0.json",
    "stZeroKnowledge/ecpairing_bad_length_191_d0g3v0.json",
    "stZeroKnowledge/ecpairing_two_points_with_one_g2_zero_d0g3v0.json",
    "stZeroKnowledge/ecpairing_one_point_insufficient_gas_d0g1v0.json",
    "stZeroKnowledge/ecpairing_one_point_with_g2_zero_d0g2v0.json",
    "stZeroKnowledge/ecpairing_perturb_zeropoint_by_field_modulus_d0g3v0.json",
    "stZeroKnowledge/ecpairing_perturb_g2_by_curve_order_d0g1v0.json",
    "stZeroKnowledge/ecpairing_one_point_not_in_subgroup_d0g0v0.json",
    "stZeroKnowledge/ecpairing_one_point_fail_d0g3v0.json",
    "stZeroKnowledge/ecpairing_two_point_fail_1_d0g1v0.json",
    "stZeroKnowledge/ecpairing_two_point_match_3_d0g0v0.json",
    "stZeroKnowledge/ecpairing_perturb_g2_by_field_modulus_again_d0g3v0.json",
    "stZeroKnowledge/pairingTest_d1g1v0.json",
    "stZeroKnowledge/pairingTest_d0g1v0.json",
    "stZeroKnowledge/ecpairing_perturb_g2_by_one_d0g0v0.json",
    "stZeroKnowledge/ecpairing_two_point_match_3_d0g2v0.json",
    "stZeroKnowledge/ecpairing_two_point_fail_1_d0g3v0.json",
    "stZeroKnowledge/ecpairing_perturb_g2_by_one_d0g2v0.json",
    "stZeroKnowledge/ecpairing_perturb_g2_by_field_modulus_again_d0g1v0.json",
    "stZeroKnowledge/pairingTest_d1g3v0.json",
    "stZeroKnowledge/pairingTest_d0g3v0.json",
    "stZeroKnowledge/ecpairing_one_point_insufficient_gas_d0g3v0.json",
    "stZeroKnowledge/ecpairing_perturb_zeropoint_by_field_modulus_d0g1v0.json",
    "stZeroKnowledge/ecpairing_one_point_with_g2_zero_d0g0v0.json",
    "stZeroKnowledge/ecpairing_two_points_with_one_g2_zero_d0g1v0.json",
    "stZeroKnowledge/ecpairing_perturb_zeropoint_by_curve_order_d0g0v0.json",
    "stZeroKnowledge/ecpairing_bad_length_191_d0g1v0.json",
    "stZeroKnowledge/ecpairing_empty_data_d0g3v0.json",
    "stZeroKnowledge/ecpairing_perturb_zeropoint_by_one_d0g1v0.json",
    "stZeroKnowledge/pairingTest_d3g0v0.json",
    "stZeroKnowledge/ecpairing_two_point_match_2_d0g1v0.json",
    "stZeroKnowledge/pairingTest_d2g0v0.json",
    "stZeroKnowledge/ecpairing_one_point_fail_d0g1v0.json",
    "stZeroKnowledge/ecpairing_one_point_not_in_subgroup_d0g2v0.json",
    "stZeroKnowledge/ecpairing_perturb_g2_by_curve_order_d0g3v0.json",
    "stReturnDataTest/modexp_modsize0_returndatasize_d4g0v0.json",
    "stReturnDataTest/modexp_modsize0_returndatasize_d2g0v0.json",
    "stReturnDataTest/modexp_modsize0_returndatasize_d3g0v0.json",
    "stReturnDataTest/modexp_modsize0_returndatasize_d1g0v0.json",
    "stRevertTest/RevertPrecompiledTouch_noncestorage_d1g0v0.json",
    "stRevertTest/RevertPrecompiledTouch_noncestorage_d0g0v0.json",
    "stRevertTest/RevertPrecompiledTouchExactOOG_d15g1v0.json",
    "stRevertTest/RevertPrecompiledTouchExactOOG_d14g1v0.json",
    "stRevertTest/RevertPrecompiledTouchExactOOG_d21g1v0.json",
    "stRevertTest/RevertPrecompiledTouch_d3g0v0.json",
    "stRevertTest/RevertPrecompiledTouch_d2g0v0.json",
    "stRevertTest/RevertPrecompiledTouchExactOOG_d31g1v0.json",
    "stRevertTest/RevertPrecompiledTouchExactOOG_d30g1v0.json",
    "stRevertTest/RevertPrecompiledTouch_storage_d3g0v0.json",
    "stRevertTest/RevertPrecompiledTouch_storage_d2g0v0.json",
    "stRevertTest/RevertPrecompiledTouchExactOOG_d5g1v0.json",
    "stRevertTest/RevertPrecompiledTouch_nonce_d2g0v0.json",
    "stRevertTest/RevertPrecompiledTouch_nonce_d3g0v0.json",
    "stRevertTest/RevertPrecompiledTouchExactOOG_d13g1v0.json",
    "stRevertTest/RevertInCreateInInit_d0g0v0.json",
    "stRevertTest/RevertPrecompiledTouch_d0g0v0.json",
    "stRevertTest/RevertPrecompiledTouch_d1g0v0.json",
    "stRevertTest/RevertPrecompiledTouchExactOOG_d22g1v0.json",
    "stRevertTest/RevertPrecompiledTouchExactOOG_d23g1v0.json",
    "stRevertTest/RevertPrecompiledTouchExactOOG_d29g1v0.json",
    "stRevertTest/RevertPrecompiledTouch_noncestorage_d2g0v0.json",
    "stRevertTest/RevertPrecompiledTouch_noncestorage_d3g0v0.json",
    "stRevertTest/RevertPrecompiledTouchExactOOG_d7g1v0.json",
    "stRevertTest/RevertPrecompiledTouchExactOOG_d6g1v0.json",
    "stRevertTest/RevertPrecompiledTouch_nonce_d1g0v0.json",
    "stRevertTest/RevertPrecompiledTouch_nonce_d0g0v0.json",
    "stRevertTest/RevertPrecompiledTouch_storage_d0g0v0.json",
    "stRevertTest/RevertPrecompiledTouch_storage_d1g0v0.json",
    "stRandom2/randomStatetest642_d0g0v0.json",
    "stStaticCall/static_CallEcrecover0_0input_d8g0v0.json",
    "stStaticCall/static_CallEcrecover0_0input_d7g0v0.json",
    "stStaticCall/static_CallEcrecover0_0input_d6g0v0.json",
)


@pytest.mark.parametrize(
    "test_file", fetch_state_test_files(test_dir, SLOW_TESTS, FIXTURES_LOADER)
)
def test_general_state_tests(test_file: str) -> None:
    try:
        run_general_state_tests(test_file)
    except KeyError:
        # FIXME: Handle tests that don't have post state
        pytest.xfail(f"{test_file} doesn't have post state")


# Run legacy valid block tests
test_dir = (
    "tests/fixtures/LegacyTests/Constantinople/BlockchainTests/ValidBlocks/"
)

run_valid_block_test = partial(
    run_byzantium_blockchain_st_tests,
    test_dir,
)


@pytest.mark.parametrize(
    "test_file_uncle_correctness",
    [
        "bcUncleTest/oneUncle.json",
        "bcUncleTest/oneUncleGeneration2.json",
        "bcUncleTest/oneUncleGeneration3.json",
        "bcUncleTest/oneUncleGeneration4.json",
        "bcUncleTest/oneUncleGeneration5.json",
        "bcUncleTest/oneUncleGeneration6.json",
        "bcUncleTest/twoUncle.json",
    ],
)
def test_uncles_correctness(test_file_uncle_correctness: str) -> None:
    run_valid_block_test(test_file_uncle_correctness)


# Run legacy invalid block tests
test_dir = (
    "tests/fixtures/LegacyTests/Constantinople/BlockchainTests/InvalidBlocks"
)

run_invalid_block_test = partial(
    run_byzantium_blockchain_st_tests,
    test_dir,
)


@pytest.mark.parametrize(
    "test_file", fetch_state_test_files(test_dir, (), FIXTURES_LOADER)
)
def test_invalid_block_tests(test_file: str) -> None:
    try:
        # Ideally correct.json should not have been in the InvalidBlocks folder
        if test_file == "bcUncleHeaderValidity/correct.json":
            run_invalid_block_test(test_file)
        else:
            with pytest.raises((EnsureError, AssertionError, ValueError)):
                run_invalid_block_test(test_file)
    except KeyError:
        # FIXME: Handle tests that don't have post state
        pytest.xfail(f"{test_file} doesn't have post state")


# Run Non-Legacy GeneralStateTests
run_general_state_tests_new = partial(
    run_byzantium_blockchain_st_tests,
    "tests/fixtures/BlockchainTests/GeneralStateTests/",
)


@pytest.mark.parametrize(
    "test_file_new",
    [
        "stCreateTest/CREATE_HighNonce.json",
        "stCreateTest/CREATE_HighNonceMinus1.json",
    ],
)
def test_general_state_tests_new(test_file_new: str) -> None:
    try:
        run_general_state_tests_new(test_file_new)
    except KeyError:
        # KeyError is raised when a test_file has no tests for frontier
        raise pytest.skip(f"{test_file_new} has no tests for frontier")
